{"version":3,"file":"utils.js","sourceRoot":"","sources":["../src/utils.ts"],"names":[],"mappings":";;;AAGA,SAAgB,WAAW,CAAC,MAAc;IACtC,MAAM,WAAW,GAAiB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC;IACvD,IAAI,cAAc,GAAG,CAAC,CAAC;IAEvB,MAAM,IAAI,GAAG,EAAE,CAAC;IAChB,IAAI,gBAAgB,GAAG,IAAI,CAAC;IAE5B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAc,EAAE,CAAC,EAAE,EAAE;QACrC,MAAM,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;QAElC,UAAU,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,EAAE;YAClC,MAAM,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC;YAC3B,MAAM,UAAU,GAAG,MAAM,CAAC,KAAK,CAAC;YAEhC,MAAM,KAAK,GAAG,CAAE,GAAc,CAAC,aAAa,CAAC,CAAC;gBAC1C,CAAC,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,aAAa,CAAC,UAAU,CAAC;gBAC9C,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YAEtC,gBAAgB,CAAC,KAAK,CAAC,GAAG,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAC9D,CAAC,CAAC,CAAC;KAEN;IAED,OAAO,IAAI,CAAC;AAChB,CAAC;AAxBD,kCAwBC","sourcesContent":["import { Schema } from \"./\";\nimport { ChangeTree } from \"./changes/ChangeTree\";\n\nexport function dumpChanges(schema: Schema) {\n    const changeTrees: ChangeTree[] = [schema['$changes']];\n    let numChangeTrees = 1;\n\n    const dump = {};\n    let currentStructure = dump;\n\n    for (let i = 0; i < numChangeTrees; i++) {\n        const changeTree = changeTrees[i];\n\n        changeTree.changes.forEach((change) => {\n            const ref = changeTree.ref;\n            const fieldIndex = change.index;\n\n            const field = ((ref as Schema)['_definition'])\n                ? ref['_definition'].fieldsByIndex[fieldIndex]\n                : ref['$indexes'].get(fieldIndex);\n\n            currentStructure[field] = changeTree.getValue(fieldIndex);\n        });\n\n    }\n\n    return dump;\n}"]}